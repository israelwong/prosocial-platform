# ProSocial Platform - Cursor Rules

## ğŸ¯ **PROYECTO OVERVIEW**

ProSocial Platform es una plataforma SaaS multi-tenant para gestiÃ³n de estudios de fotografÃ­a con:

- **Next.js 15.5.2** (App Router) + **TypeScript 5** + **Tailwind CSS 4**
- **React 19.1.0** + **Supabase** (Auth + Database) + **Prisma 6.15.0** (ORM)
- **Stripe** (Pagos) + **Shadcn/ui** (Componentes)
- **Arquitectura Multi-tenant** con roles: Super Admin, Asesor, Suscriptor

### **Estado de Versiones**
- âœ… **Next.js 15.5.2** - Ãšltima versiÃ³n estable (26 agosto 2024)
- âœ… **React 19.1.0** - Ãšltima versiÃ³n estable con nuevas caracterÃ­sticas
- âœ… **TypeScript 5** - Ãšltima versiÃ³n estable con mejoras de rendimiento
- âœ… **Todas las dependencias** actualizadas a versiones compatibles

## ğŸ—ï¸ **ARQUITECTURA Y ESTRUCTURA**

### **Estructura de Directorios**

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ (marketing)/       # Marketing pÃºblico
â”‚   â”œâ”€â”€ admin/             # Panel de administraciÃ³n
â”‚   â”œâ”€â”€ asesor/            # Panel de asesores
â”‚   â”œâ”€â”€ api/               # API Routes
â”‚   â””â”€â”€ studio/            # Landing pages de estudios
â”œâ”€â”€ components/            # Componentes reutilizables
â”œâ”€â”€ lib/                   # Utilidades y configuraciones
â””â”€â”€ types/                 # Definiciones TypeScript
```

### **Rutas Principales**

- `/admin/*` - Panel de administraciÃ³n (Super Admin)
- `/asesor/*` - Panel de asesores
- `/studio/[slug]` - Landing page de estudios
- `/api/*` - API endpoints

## ğŸ¨ **DISEÃ‘O Y UI/UX**

### **Tema Oscuro (Zinc)**

```css
/* Colores principales */
bg-zinc-950    /* Fondo principal */
bg-zinc-900    /* Cards y contenedores */
bg-zinc-800    /* Bordes y separadores */
text-white     /* Texto principal */
text-zinc-300  /* Texto secundario */
```

### **Componentes UI**

- **Shadcn/ui** como base de componentes
- **Lucide React** para iconos
- **Tailwind CSS** para estilos
- **Sonner** para notificaciones toast

### **Patrones de DiseÃ±o**

- **Cards** con `bg-zinc-900 border-zinc-800`
- **Botones** con colores semÃ¡nticos (blue-600, red-600, etc.)
- **Formularios** con validaciÃ³n y estados de carga
- **Modales** para acciones CRUD

## ğŸ”§ **DESARROLLO Y CÃ“DIGO**

### **TypeScript**

- **Strict mode** habilitado
- **Interfaces** para todos los tipos de datos
- **Tipado fuerte** en props y estados
- **Paths aliases** con `@/*` para imports

### **React Patterns**

```typescript
// Componentes funcionales con hooks
"use client";

// Estados con useState
const [loading, setLoading] = useState(false);

// Efectos con dependencias correctas
useEffect(() => {
  fetchData();
}, [dependency]);

// useCallback para funciones en dependencias
const fetchData = useCallback(async () => {
  // ...
}, [dependency]);
```

### **Next.js App Router**

- **Server Components** por defecto
- **Client Components** con `'use client'` cuando necesario
- **API Routes** en `app/api/`
- **Dynamic routes** con `[id]` o `[slug]`

## ğŸ—„ï¸ **BASE DE DATOS Y API**

### **Prisma Schema**

- **Modelos** con naming convention `ProSocial*`
- **Relaciones** bien definidas con `@relation`
- **Ãndices** para optimizaciÃ³n de queries
- **Campos** con tipos apropiados (String, Int, DateTime, Decimal)

### **API Routes**

```typescript
// Estructura estÃ¡ndar
export async function GET(request: Request) {
  try {
    // LÃ³gica de negocio
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json({ error: "Message" }, { status: 500 });
  }
}
```

### **Supabase Integration**

- **Auth** con `@supabase/ssr`
- **RLS** (Row Level Security) habilitado
- **Client/Server** separation correcta

## ğŸš€ **FUNCIONALIDADES PRINCIPALES**

### **Sistema de Leads (CRM)**

- **Kanban Board** con drag & drop
- **Pipeline** configurable por etapas
- **BitÃ¡cora** de actividades
- **Canales de adquisiciÃ³n** trackeables

### **GestiÃ³n de CampaÃ±as**

- **CampaÃ±as activas** vs **historial**
- **Plataformas** de publicidad
- **MÃ©tricas** de ROI y conversiÃ³n

### **Multi-tenant**

- **Estudios** como tenants
- **Roles** y permisos granulares
- **Aislamiento** de datos por tenant

## ğŸ“ **CONVENCIONES DE CÃ“DIGO**

### **Naming**

- **Archivos**: kebab-case (`lead-form.tsx`)
- **Componentes**: PascalCase (`LeadForm`)
- **Variables**: camelCase (`leadData`)
- **Constantes**: UPPER_SNAKE_CASE (`API_BASE_URL`)

### **Imports**

```typescript
// Orden de imports
import React from "react";
import { NextResponse } from "next/server";
import { PrismaClient } from "@prisma/client";
import { Button } from "@/components/ui/button";
import { LeadForm } from "./components/LeadForm";
```

### **Error Handling**

```typescript
try {
  // OperaciÃ³n
} catch (error) {
  console.error("Error context:", error);
  toast.error("Mensaje de error para usuario");
  // Fallback o estado de error
}
```

## ğŸ”’ **SEGURIDAD Y VALIDACIÃ“N**

### **AutenticaciÃ³n**

- **Supabase Auth** con JWT
- **Middleware** para protecciÃ³n de rutas
- **RLS** en base de datos

### **ValidaciÃ³n**

- **Zod** para schemas de validaciÃ³n
- **React Hook Form** para formularios
- **ValidaciÃ³n** tanto cliente como servidor

## ğŸ§ª **TESTING Y CALIDAD**

### **Linting**

- **ESLint** con configuraciÃ³n Next.js
- **TypeScript** strict mode
- **Prettier** para formato (si estÃ¡ configurado)

### **Performance**

- **Dynamic imports** para code splitting
- **Image optimization** con Next.js Image
- **Prisma** queries optimizadas

## ğŸ“¦ **DEPENDENCIAS PRINCIPALES**

### **Core**

- `next@15.5.2` - Framework (Ãºltima versiÃ³n estable)
- `react@19.1.0` - UI Library (Ãºltima versiÃ³n estable)
- `typescript@5` - Type Safety (Ãºltima versiÃ³n estable)

### **UI/UX**

- `@radix-ui/*` - Componentes primitivos
- `tailwindcss@4` - Styling
- `lucide-react` - Iconos
- `sonner` - Notificaciones

### **Backend**

- `@prisma/client@6.15.0` - ORM
- `@supabase/supabase-js@2.57.4` - Backend
- `stripe@18.5.0` - Pagos

### **Utilities**

- `@dnd-kit/*` - Drag & Drop
- `react-hook-form` - Formularios
- `zod` - ValidaciÃ³n
- `date-fns` - Fechas

## ğŸ¯ **MEJORES PRÃCTICAS**

### **Componentes**

- **Reutilizables** y modulares
- **Props** bien tipadas
- **Estados** locales cuando sea posible
- **Loading states** y error boundaries

### **Performance**

- **useCallback** para funciones en dependencias
- **useMemo** para cÃ¡lculos costosos
- **Dynamic imports** para componentes pesados
- **Optimistic updates** cuando sea apropiado

### **Accesibilidad**

- **Semantic HTML** correcto
- **ARIA labels** cuando sea necesario
- **Keyboard navigation** funcional
- **Color contrast** adecuado

## ğŸš¨ **ANTI-PATRONES A EVITAR**

### **âŒ No hacer**

- Usar `any` type en TypeScript
- Mutar props directamente
- Usar `useEffect` sin dependencias correctas
- Hardcodear strings en lugar de constantes
- Ignorar errores de linting
- Usar Prisma en client-side components

### **âœ… SÃ­ hacer**

- Tipado fuerte en TypeScript
- Inmutabilidad en estados
- Dependencias correctas en hooks
- Constantes para valores mÃ¡gicos
- CÃ³digo limpio sin warnings
- API routes para operaciones de DB

## ğŸ”„ **FLUJO DE DESARROLLO**

### **Nuevas Features**

1. **DiseÃ±ar** la estructura de datos en Prisma
2. **Crear** API routes necesarias
3. **Implementar** componentes UI
4. **Conectar** frontend con backend
5. **Testear** funcionalidad completa
6. **Optimizar** performance si es necesario

### **Debugging**

- **Console.log** para debugging temporal
- **React DevTools** para inspeccionar estados
- **Prisma Studio** para ver datos
- **Network tab** para API calls

## ğŸ“š **RECURSOS Y DOCUMENTACIÃ“N**

### **DocumentaciÃ³n del Proyecto (docs/)**

**ESTRUCTURA ORGANIZADA:**

- `docs/01-architecture/` - Arquitectura y diseÃ±o del sistema
- `docs/02-implementation/` - GuÃ­as de implementaciÃ³n paso a paso
- `docs/03-troubleshooting/` - SoluciÃ³n de problemas conocidos
- `docs/04-best-practices/` - Mejores prÃ¡cticas y estÃ¡ndares
- `docs/05-legacy/` - CÃ³digo legacy y migraciÃ³n
- `docs/06-reference/` - Referencias y configuraciones

**CONSULTAR SIEMPRE:**

- `docs/README.md` - Ãndice principal de documentaciÃ³n
- `docs/04-best-practices/TYPESCRIPT_BEST_PRACTICES.md` - Reglas de TypeScript
- `docs/02-implementation/KANBAN_IMPLEMENTATION_GUIDE.md` - GuÃ­a del Kanban

### **DocumentaciÃ³n Oficial**

- [Next.js 15 Docs](https://nextjs.org/docs)
- [Prisma Docs](https://www.prisma.io/docs)
- [Supabase Docs](https://supabase.com/docs)
- [Tailwind CSS](https://tailwindcss.com/docs)

### **Componentes**

- [Shadcn/ui](https://ui.shadcn.com/)
- [Radix UI](https://www.radix-ui.com/)
- [Lucide Icons](https://lucide.dev/)

---

## ğŸ¯ **INSTRUCCIONES ESPECÃFICAS PARA CURSOR**

### **ğŸ” CONSULTA DE DOCUMENTACIÃ“N (OBLIGATORIO)**

**ANTES de resolver cualquier problema, SIEMPRE:**

1. **Consultar** la documentaciÃ³n en `/docs/` para soluciones existentes
2. **Revisar** especialmente:
   - `docs/03-troubleshooting/` - Para problemas conocidos
   - `docs/04-best-practices/` - Para patrones establecidos
   - `docs/02-implementation/` - Para guÃ­as de implementaciÃ³n
3. **Buscar** en archivos de documentaciÃ³n antes de proponer nuevas soluciones
4. **Verificar** si el problema ya fue documentado y resuelto

### **ğŸ“ DOCUMENTACIÃ“N DE SOLUCIONES (CRÃTICO)**

**NUNCA documentar automÃ¡ticamente. SIEMPRE preguntar:**

1. **DespuÃ©s de resolver un problema**, preguntar al usuario:
   > "Â¿EstÃ¡s listo para que documente esta soluciÃ³n?"
2. **Esperar confirmaciÃ³n** antes de crear/actualizar documentaciÃ³n
3. **Validar** que la soluciÃ³n sea definitiva y no temporal
4. **Confirmar** que el usuario estÃ¡ satisfecho con la implementaciÃ³n

**RazÃ³n**: Las soluciones pueden ser prematuras o no definitivas. El usuario debe validar antes de documentar.

### **ğŸ”„ FLUJO DE TRABAJO CON DOCUMENTACIÃ“N**

**PROCESO OBLIGATORIO:**

1. **Problema identificado** â†’ Consultar `docs/03-troubleshooting/`
2. **SoluciÃ³n encontrada** â†’ Implementar y probar
3. **SoluciÃ³n validada** â†’ Preguntar al usuario si documentar
4. **ConfirmaciÃ³n recibida** â†’ Documentar en categorÃ­a apropiada
5. **DocumentaciÃ³n actualizada** â†’ Actualizar Ã­ndice en `docs/README.md`

**CATEGORÃAS DE DOCUMENTACIÃ“N:**

- **Problemas tÃ©cnicos** â†’ `docs/03-troubleshooting/`
- **Patrones de cÃ³digo** â†’ `docs/04-best-practices/`
- **GuÃ­as de implementaciÃ³n** â†’ `docs/02-implementation/`
- **Decisiones arquitectÃ³nicas** â†’ `docs/01-architecture/`

### **Al crear componentes:**

1. **Usar** el tema oscuro zinc consistente
2. **Implementar** estados de loading y error
3. **Tipar** todas las props e interfaces (NUNCA usar `any`)
4. **Seguir** los patrones de diseÃ±o establecidos
5. **Optimizar** para performance desde el inicio

### **Al modificar APIs:**

1. **Mantener** compatibilidad con frontend existente
2. **Validar** inputs con Zod
3. **Manejar** errores apropiadamente
4. **Documentar** cambios en tipos
5. **Testear** endpoints manualmente

### **Al trabajar con base de datos:**

1. **Usar** Prisma Client correctamente
2. **Optimizar** queries con includes selectivos
3. **Manejar** transacciones cuando sea necesario
4. **Respetar** RLS policies de Supabase
5. **Migrar** schema cuando sea necesario

### **Al implementar nuevas features:**

1. **Seguir** la arquitectura multi-tenant
2. **Implementar** permisos por rol
3. **Mantener** consistencia con el diseÃ±o
4. **Optimizar** para mobile y desktop
5. **Documentar** funcionalidades complejas (solo despuÃ©s de confirmaciÃ³n)

---

**Â¡MantÃ©n el cÃ³digo limpio, tipado y siguiendo estas convenciones para un desarrollo eficiente! ğŸš€**
