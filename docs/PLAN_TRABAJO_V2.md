# üìã PLAN DE TRABAJO V2.0 - Tracking Detallado

**Branch:** `v2-foundation`  
**Inicio:** 2 de Octubre, 2025  
**Meta:** MVP Studio funcional en 2 semanas

---

## üéØ RESUMEN EJECUTIVO

| Fase                        | Duraci√≥n    | Estado         | Completado     |
| --------------------------- | ----------- | -------------- | -------------- |
| **Fase 0: Fundamentos**     | 3-4 d√≠as    | üü¢ En progreso | 67% (2.5/4 d√≠as) |
| **Iteraci√≥n 1: Studio MVP** | 2 semanas   | ‚ö™ Pendiente   | 0%             |
| **Iteraci√≥n 2: Admin**      | 1.5 semanas | ‚ö™ Pendiente   | 0%             |
| **Iteraci√≥n 3: Agente CRM** | 1 semana    | ‚ö™ Pendiente   | 0%             |
| **Iteraci√≥n 4: ZEN Magic**  | 3 d√≠as      | ‚ö™ Pendiente   | 0%             |

---

## üî∑ FASE 0: FUNDAMENTOS (3-4 d√≠as)

**Objetivo:** Base de datos V2.0 completa + Sistema de m√≥dulos funcional

### **üìÖ D√≠a 1: Arquitectura de Base de Datos** ‚úÖ COMPLETADO

#### Database Schema Transformation

- [x] Crear rama `backup-pre-v2` (respaldo seguro)
- [x] Crear rama `v2-foundation` (trabajo activo)
- [x] Renombrar modelo `projects` ‚Üí `studios`
- [x] Cambiar TODAS las propiedades `projectId` ‚Üí `studio_id`
- [x] Aplicar `snake_case` a TODAS las columnas
- [x] Renombrar TODAS las tablas `project_*` ‚Üí `studio_*`
- [x] Agregar prefijos `platform_*` o `studio_*` a tablas ambiguas

#### Nuevos Modelos V2.0

- [x] Sistema de M√≥dulos: `platform_modules`, `studio_modules`
- [x] Usuarios Multi-Contexto: `users`, `user_platform_roles`, `user_studio_roles`, `studio_role_permissions`
- [x] Pipelines Marketing: `marketing_pipeline_stages`, `marketing_leads`, `marketing_lead_activities`, `marketing_quotes`, `marketing_lead_notes`
- [x] Pipelines Manager: `manager_pipeline_stages`, `manager_events`, `manager_event_tasks`, `manager_event_deliverables`, `manager_event_team`
- [x] Gantt Templates: `gantt_templates`, `gantt_template_tasks`, `gantt_event_instances`, `gantt_event_tasks`, `gantt_task_activity`

#### Validaci√≥n

- [x] `npx prisma validate` sin errores
- [x] `npx prisma format` aplicado
- [x] Commit con mensaje descriptivo
- [x] Documentar en `docs/DECISIONES_V2.md`

**Resultado:** Schema 2,117 l√≠neas, 100% validado ‚úÖ

---

### **üìÖ D√≠a 2: Migraci√≥n + Seeds Base** ‚úÖ COMPLETADO

#### Aplicar Migraci√≥n ‚úÖ COMPLETADO

- [x] Respaldar base de datos actual (rama backup-pre-v2)
- [x] `npx prisma migrate reset --force` (base de datos limpia)
- [x] `npx prisma migrate dev --name init_v2_architecture`
- [x] `npx prisma generate` (cliente TypeScript generado)
- [x] Verificar que no hay errores de migraci√≥n

#### Seed: M√≥dulos Platform ‚úÖ COMPLETADO

```typescript
// prisma/seeds/modules-seed.ts ‚úÖ
- [x] Crear seed de platform_modules:
  - [x] ZEN Manager (CORE, incluido en todos)
  - [x] ZEN Magic (CORE, planes Pro+)
  - [x] ZEN Marketing (CORE, planes Pro+)
  - [x] ZEN Payment (ADDON, +$10 USD/mes)
  - [x] ZEN Cloud (ADDON, +$15 USD/mes)
  - [x] ZEN Conversations (ADDON, +$15 USD/mes)
  - [x] ZEN Invitation (ADDON, +$12 USD/mes)
```

#### Seed: Usuarios de Prueba ‚úÖ COMPLETADO

```typescript
// prisma/seed-v2.ts (integrado) ‚úÖ
- [x] Crear usuarios base:
  - [x] Super Admin (platform_role: SUPER_ADMIN)
  - [x] Studio Owner de prueba (platform_role: SUSCRIPTOR + studio_role: OWNER)
```

#### Activar M√≥dulos en Studios ‚úÖ COMPLETADO

```typescript
// prisma/seed-v2.ts (integrado) ‚úÖ
- [x] Activar m√≥dulos core en studio de prueba:
  - [x] ZEN Manager ‚Üí is_active: true
  - [x] ZEN Magic ‚Üí is_active: true
  - [x] ZEN Marketing ‚Üí is_active: true
```

#### Seed: Pipelines V2.0 ‚úÖ COMPLETADO

```typescript
// prisma/seeds/pipelines-v2-seed.ts ‚úÖ
- [x] Marketing Pipeline (7 stages):
  - [x] Lead Nuevo, Contactado, Calificado
  - [x] Propuesta Enviada, Negociaci√≥n
  - [x] Ganado, Perdido
- [x] Manager Pipeline (7 stages):
  - [x] Planeaci√≥n, Preparaci√≥n, Producci√≥n
  - [x] Post-Producci√≥n, Entrega, Garant√≠a, Completado
```

#### Seed: Tipos de Evento ‚úÖ COMPLETADO

```typescript
- [x] Boda, XV A√±os, Sesi√≥n Familiar, Sesi√≥n Embarazo
```

#### Helper Functions ‚úÖ COMPLETADO

```typescript
// src/lib/modules/index.ts ‚úÖ
- [x] Crear helper `checkStudioModule(studioId, moduleSlug)` - Validaci√≥n B√ÅSICA (sin planes)
- [x] Crear helper `getActiveModules(studioId)` - Listar m√≥dulos activos
- [x] Crear helper `getModuleInfo(moduleSlug)` - Info de m√≥dulo espec√≠fico
- [x] Crear helper `checkMultipleModules(studioId, moduleSlugs[])` - Verificaci√≥n m√∫ltiple
- [x] Crear helper `getAllModulesWithStatus(studioId)` - Todos los m√≥dulos con estado
- [x] Testing manual exitoso (8 tests pasados)
- [x] Documentaci√≥n completa en README.md

NOTA: Validaci√≥n completa con planes (checkStudioModuleWithPlan) ‚Üí Iteraci√≥n 2 (Admin)
```

**Criterio de √âxito:**

- ‚úÖ Migraci√≥n sin errores
- ‚úÖ Base de datos con modelos V2.0
- ‚úÖ M√≥dulos creados y activados
- ‚úÖ Pipelines V2.0 funcionando
- ‚úÖ Usuarios y studio demo creados
- ‚ö™ Helpers ‚Üí D√≠a 3

**Tiempo real:** 6 horas

---

### **üìÖ D√≠a 3: Pipelines + Stages Seeds** ‚ö™ Pendiente

#### Seed: Marketing Pipeline (CRM)

```typescript
// prisma/seeds/marketing-pipeline-seed.ts
- [ ] Stages por defecto para Marketing:
  - [ ] Lead Nuevo (PROSPECTING, orden: 0)
  - [ ] Contactado (PROSPECTING, orden: 1)
  - [ ] Calificado (QUALIFICATION, orden: 2)
  - [ ] Propuesta Enviada (PROPOSAL, orden: 3)
  - [ ] Negociaci√≥n (PROPOSAL, orden: 4)
  - [ ] Ganado (CONVERSION, orden: 5, is_system: true)
  - [ ] Perdido (CLOSED_LOST, orden: 6, is_system: true)
```

#### Seed: Manager Pipeline (Operacional)

```typescript
// prisma/seeds/manager-pipeline-seed.ts
- [ ] Stages por defecto para Manager:
  - [ ] Planeaci√≥n (PLANNING, orden: 0)
  - [ ] Preparaci√≥n (PLANNING, orden: 1)
  - [ ] Producci√≥n (PRODUCTION, orden: 2)
  - [ ] Post-Producci√≥n (POST_PRODUCTION, orden: 3)
  - [ ] Revisi√≥n Cliente (REVIEW, orden: 4)
  - [ ] Entrega (DELIVERY, orden: 5)
  - [ ] Completado (COMPLETED, orden: 6, is_system: true)
```

#### Testing de Pipelines

```typescript
- [ ] Crear lead de prueba en Marketing
- [ ] Mover lead entre stages
- [ ] Convertir lead a evento (Manager)
- [ ] Validar relaci√≥n bidireccional
```

**Criterio de √âxito:**

- ‚úÖ Stages de ambos pipelines creados
- ‚úÖ Leads y eventos de prueba funcionan
- ‚úÖ Flujo de conversi√≥n Lead ‚Üí Evento funciona

**Tiempo estimado:** 3-4 horas

---

### **üìÖ D√≠a 4: Gantt Templates Seeds** ‚ö™ Pendiente

#### Seed: Templates B√°sicos

```typescript
// prisma/seeds/gantt-templates-seed.ts
- [ ] Template "Boda Standard" (45 d√≠as, 15 tareas)
  - [ ] Pre-evento: Reuni√≥n inicial, visita locaci√≥n, sesi√≥n pre-boda, preparar equipo
  - [ ] Evento: Cobertura del evento
  - [ ] Post-evento: Backup, selecci√≥n, edici√≥n, revisi√≥n, entrega

- [ ] Template "Sesi√≥n Familiar Express" (7 d√≠as, 4 tareas)
  - [ ] Coordinar locaci√≥n
  - [ ] Sesi√≥n fotogr√°fica
  - [ ] Selecci√≥n y edici√≥n
  - [ ] Entrega digital

- [ ] Template "XV A√±os" (30 d√≠as, 12 tareas)
  - [ ] Similar a boda pero m√°s corto
```

#### Testing de Gantt

```typescript
- [ ] Crear evento de prueba
- [ ] Aplicar template "Boda Standard"
- [ ] Verificar que se crean tareas con fechas calculadas
- [ ] Asignar tarea a usuario
- [ ] Marcar tarea como completada
- [ ] Validar progreso del evento
```

#### Documentaci√≥n

```markdown
- [ ] Actualizar README con setup de base de datos
- [ ] Documentar sistema de m√≥dulos
- [ ] Documentar pipelines duales
- [ ] Documentar Gantt templates
```

**Criterio de √âxito:**

- ‚úÖ Templates creados y funcionando
- ‚úÖ Aplicaci√≥n de templates funciona
- ‚úÖ C√°lculo de fechas correcto
- ‚úÖ Documentaci√≥n actualizada

**Tiempo estimado:** 4-5 horas

---

## ‚úÖ CHECKLIST FASE 0 COMPLETA

Antes de iniciar Iteraci√≥n 1, validar:

- [ ] Base de datos migrada sin errores
- [ ] Prisma client generado correctamente
- [ ] M√≥dulos activados en studio de prueba
- [ ] Helpers de m√≥dulos funcionando
- [ ] Ambos pipelines con stages creados
- [ ] Templates Gantt funcionando
- [ ] Seeds ejecutados exitosamente
- [ ] Documentaci√≥n actualizada
- [ ] Commit de Fase 0 completa
- [ ] Sin errores en consola

---

## üî∑ ITERACI√ìN 1: STUDIO MVP (2 semanas)

**Objetivo:** M√≥dulo ZEN Manager completamente funcional para fot√≥grafos

### **üìÖ Semana 1: Layout + Manager Kanban**

#### D√≠a 5-6: Layout Base con ZEN Design System

```typescript
// src/app/studio/[slug]/layout.tsx
- [ ] Crear layout base con sidebar
- [ ] ZenSidebar con navegaci√≥n por m√≥dulos
- [ ] ZenNavbar con user dropdown
- [ ] Verificar m√≥dulos activos del studio
- [ ] Ocultar m√≥dulos no activos
- [ ] Responsive mobile-first
```

#### D√≠a 7-8: Dashboard Studio

```typescript
// src/app/studio/[slug]/page.tsx
- [ ] M√©tricas b√°sicas (ZenCard)
  - [ ] Eventos este mes
  - [ ] Pendientes de pago
  - [ ] Pr√≥ximos eventos (7 d√≠as)
- [ ] Lista pr√≥ximos eventos (ZenTable)
- [ ] Gr√°fico simple de ingresos (opcional)
```

#### D√≠a 9-11: Kanban Manager (Pipeline Operacional)

```typescript
// src/app/studio/[slug]/manager/kanban/page.tsx
- [ ] Vista Kanban con columnas por stage
- [ ] Drag & drop eventos entre stages
- [ ] Modal crear evento (ZenModal + ZenForm)
- [ ] Modal editar evento
- [ ] Filtros: fecha, tipo evento, cliente
- [ ] Server Actions:
  - [ ] crearEvento(data)
  - [ ] actualizarEvento(id, data)
  - [ ] moverEtapa(eventoId, nuevaEtapaId)
  - [ ] eliminarEvento(id)
```

**Componentes ZEN a crear:**

- [ ] EventoCard (muestra info del evento en kanban)
- [ ] EventoModal (formulario crear/editar)
- [ ] StageColumn (columna del kanban)
- [ ] EventoFilters (filtros de b√∫squeda)

---

### **üìÖ Semana 2: Gantt + Agenda**

#### D√≠a 12-14: Sistema Gantt Templates

```typescript
// src/app/studio/[slug]/manager/evento/[id]/gantt/page.tsx
- [ ] Vista timeline del evento
- [ ] Selector de template (si no tiene)
- [ ] Lista de tareas con fechas
- [ ] Editar tarea (modal)
- [ ] Asignar personal a tarea
- [ ] Marcar tarea completada
- [ ] Indicadores de progreso (%)
- [ ] Alertas de tareas atrasadas

// src/app/studio/[slug]/configuracion/gantt-templates/page.tsx
- [ ] Lista templates del studio
- [ ] Crear template nuevo
- [ ] Editar template existente
- [ ] Agregar/quitar tareas del template
- [ ] Preview del template
```

**Server Actions:**

```typescript
- [ ] aplicarTemplate(eventoId, templateId)
- [ ] crearTemplate(studioId, data)
- [ ] actualizarTarea(tareaId, data)
- [ ] completarTarea(tareaId, userId)
```

#### D√≠a 15-16: Agenda de Eventos

```typescript
// src/app/studio/[slug]/manager/agenda/page.tsx
- [ ] Calendario mensual (ZenCalendar o custom)
- [ ] Vista lista con filtros
- [ ] C√≥digos de color por tipo evento
- [ ] Click evento ‚Üí Modal detalle
- [ ] Integraci√≥n Google Calendar (b√°sica)
```

---

## üìä M√âTRICAS DE √âXITO POR FASE

### Fase 0

- ‚úÖ 0 errores en migraci√≥n
- ‚úÖ Schema validado 100%
- ‚úÖ M√≥dulos funcionando
- ‚úÖ Pipelines con data de prueba
- ‚úÖ Templates Gantt aplicables

### Iteraci√≥n 1 (Studio)

- üéØ Crear evento completo end-to-end
- üéØ Kanban drag & drop funcional
- üéØ Aplicar template Gantt a evento
- üéØ Ver agenda mensual de eventos
- üéØ Asignar tareas a personal
- üéØ Marcar progreso de tareas

---

## üîÑ TRACKING DE PROGRESO

### C√≥mo usar este documento:

1. ‚úÖ Marcar checkboxes conforme se completan
2. üìù Agregar notas si hay bloqueos
3. ‚è±Ô∏è Actualizar tiempos reales vs estimados
4. üö® Escalar decisiones cr√≠ticas
5. üéØ Validar criterios de √©xito antes de avanzar

### Estado actual:

- **√öltima actualizaci√≥n:** 2025-10-02 (D√≠a 3 completado - 67% Fase 0)
- **Siguiente paso:** D√≠a 4 - Gantt Templates (opcional) o saltar a Iteraci√≥n 1 (Studio MVP)
- **Bloqueadores:** Ninguno
- **Notas:** 
  - Seed V2.0 ‚úÖ (7 m√≥dulos, 2 pipelines con 14 stages, 2 usuarios, 4 tipos de evento)
  - Helpers de m√≥dulos ‚úÖ (5 funciones, testing completo, documentaci√≥n)
  - Listo para iniciar frontend Studio MVP

---

## üìå PR√ìXIMAS ITERACIONES (Referencia)

### Iteraci√≥n 2: Admin (1.5 semanas)

- **Gesti√≥n de m√≥dulos platform**
  - CRUD de m√≥dulos (crear, editar, desactivar)
  - Asignaci√≥n de m√≥dulos a planes
  - Configuraci√≥n de precios y billing_type
- **Gesti√≥n de planes y suscripciones** ‚≠ê VALIDACI√ìN COMPLETA
  - CRUD de planes (Basic, Pro, Enterprise)
  - L√≠mites por plan (eventos/mes, storage, usuarios)
  - M√≥dulos incluidos por plan
  - **Validaci√≥n completa de planes:**
    - `checkStudioModuleWithPlan()` - Validar suscripci√≥n + plan + m√≥dulo
    - Verificar l√≠mites de uso (eventos, storage, etc.)
    - Bloqueo por suscripci√≥n vencida
    - Stripe integration para billing
- **Gesti√≥n de usuarios y roles**
  - CRUD de usuarios platform y studio
  - Asignaci√≥n de roles y permisos
- **Pipelines globales (default stages)**
- **Analytics b√°sicos**

### Iteraci√≥n 3: Agente CRM (1 semana)

- Kanban Marketing (leads)
- Gesti√≥n de leads
- Cotizaciones
- Conversi√≥n lead ‚Üí evento
- Dashboard agente

### Iteraci√≥n 4: ZEN Magic (3 d√≠as)

- Chat con Claude
- Function calling a Server Actions
- Queries conversacionales
- Rate limiting

---

**Responsable:** Israel Wong  
**Status:** üü¢ Fase 0 - D√≠a 1 completado  
**Pr√≥ximo:** D√≠a 2 - Migraci√≥n de base de datos
